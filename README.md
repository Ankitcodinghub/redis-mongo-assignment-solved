# redis-mongo-assignment-solved
**TO GET THIS SOLUTION VISIT:** [Redis-Mongo Assignment Solved](https://www.ankitcodinghub.com/product/redis-mongo-assignment-solved/)


---

üì© **If you need this solution or have special requests:** **Email:** ankitcoding@gmail.com  
üì± **WhatsApp:** +1 419 877 7882  
üìÑ **Get a quote instantly using this form:** [Ask Homework Questions](https://www.ankitcodinghub.com/services/ask-homework-questions/)

*We deliver fast, professional, and affordable academic help.*

---

<h2>Description</h2>



<div class="kk-star-ratings kksr-auto kksr-align-center kksr-valign-top" data-payload="{&quot;align&quot;:&quot;center&quot;,&quot;id&quot;:&quot;96295&quot;,&quot;slug&quot;:&quot;default&quot;,&quot;valign&quot;:&quot;top&quot;,&quot;ignore&quot;:&quot;&quot;,&quot;reference&quot;:&quot;auto&quot;,&quot;class&quot;:&quot;&quot;,&quot;count&quot;:&quot;0&quot;,&quot;legendonly&quot;:&quot;&quot;,&quot;readonly&quot;:&quot;&quot;,&quot;score&quot;:&quot;0&quot;,&quot;starsonly&quot;:&quot;&quot;,&quot;best&quot;:&quot;5&quot;,&quot;gap&quot;:&quot;4&quot;,&quot;greet&quot;:&quot;Rate this product&quot;,&quot;legend&quot;:&quot;0\/5 - (0 votes)&quot;,&quot;size&quot;:&quot;24&quot;,&quot;title&quot;:&quot;Redis-Mongo Assignment Solved&quot;,&quot;width&quot;:&quot;0&quot;,&quot;_legend&quot;:&quot;{score}\/{best} - ({count} {votes})&quot;,&quot;font_factor&quot;:&quot;1.25&quot;}">

<div class="kksr-stars">

<div class="kksr-stars-inactive">
            <div class="kksr-star" data-star="1" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="2" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="3" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="4" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="5" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
    </div>

<div class="kksr-stars-active" style="width: 0px;">
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
    </div>
</div>


<div class="kksr-legend" style="font-size: 19.2px;">
            <span class="kksr-muted">Rate this product</span>
    </div>
    </div>
<div class="page" title="Page 1">
<div class="layoutArea">
<div class="column">
You are going to use REDIS and MongoDB to perform an analysis on data related to classified ads from the used motorcycles market.

<ol>
<li>Install REDIS and MongoDB on your workstations. Version 4 of REDIS for windows is available here: https://github.com/tporadowski/redis/releases If you have an older version, make sure that you upgrade since some of the commands needed for the assignment are not supported by older versions. The installation process is straightforward.</li>
<li>Download the BIKES_DATASET.zip dataset from https://drive.google.com/open?id=1m4W6anTDphWRnHDwsh-hlexOGrAkMrSq</li>
<li>Download the RECORDED_ACTIONS.zip dataset from https://drive.google.com/open?id=1wyL8nQKDEu6rdr9BH6CgBwGnPnvRT8cJ</li>
<li>Do the tasks listed in the ‚ÄúTASKS‚Äù section:
SCENARIO
</li>
</ol>
You are a data analyst at a consulting firm and you have access to a dataset of ~30K classified ads from the used motorcycles market. You also have access to some seller related actions that have been tracked in the previous months. You are asked to create a number of programs/queries for the tasks listed in the ‚ÄúTASKS‚Äù section.

<pre>                         ASSIGNMENT NOTES
</pre>
<ul>
<li>‚Äì &nbsp;You may work on any programming language of your choice. Code samples are provided in R but the choice of language is up to you.</li>
<li>‚Äì &nbsp;Working with R is recommended, since the material uploaded on Moodle uses R in order to demonstrate Redis‚Äô usage.</li>
<li>‚Äì &nbsp;Assignment should be done in groups of two.</li>
<li>‚Äì &nbsp;The dataset is in JSON format. It needs cleaning. You don‚Äôt need to follow
the guidelines provided below. You may do the cleaning any way you like.
</li>
<li>‚Äì &nbsp;In your deliverable, you should include (along with your code) a report justifying the steps you took in order to perform the tasks. The report
should be VERY brief.
</li>
<li>‚Äì &nbsp;ONE deliverable per team. The names of the members of each team along with
their AM should be included in the first page of the report.
</li>
<li>‚Äì &nbsp;Your code should be fully commented.</li>
<li>‚Äì &nbsp;Your deliverable should be a .zip file named as AM1_AM2.zip</li>
<li>‚Äì &nbsp;Optional tasks will have no effect on your final grade. However it‚Äôs
strongly recommended that you at least try these out in order to understand the actual benefit of the tools/technologies that you are using.
</li>
</ul>
</div>
</div>
</div>
<div class="page" title="Page 2">
<div class="layoutArea">
<div class="column">
<ul>
<li>‚Äì &nbsp;You don‚Äôt have to follow the tips provided in the tasks. You can do it any way you prefer. However, they may come in handy.</li>
<li>‚Äì &nbsp;The bitmaps.r file contains code samples for working with bitmaps and REDIS through R.</li>
<li>‚Äì &nbsp;The mongo.r file contains code samples for working with MongoDB and JSON files through R.</li>
</ul>
</div>
</div>
<div class="layoutArea">
<div class="column">
TASKS

In this task you are going to use the ‚Äúrecorded actions‚Äù dataset in order to

generate some analytics with REDIS.

At the end of each month, the classifieds provider sends a personalized e- mail to some of the sellers with a number of suggestions on how they could improve their listings. Some e-mails may have been sent two or three times in the same month due to a technical issue. Not all users open these e-mails. However, we keep track of the e-mails that have been read by their recipients. Apart from that you are also given access to a dataset containing all the user ids along with a flag on whether they performed at least one modification on their listing for each month.

In brief, the datasets are the following:

‚Äì emails_sent.csv ‚ÄúSets of EmailID, UserID, MonthID and EmailOpened‚Äù ‚Äì modified_listings.csv ‚ÄúSets of UserID, MonthID, ModifiedListing‚Äù

The first dataset contains User IDs that have received an e-mail at least once. The second dataset contains all the User IDs of the classifieds provider and a flag that indicates whether the user performed a modification on his/her listing. Both datasets contain entries for the months January, February and March.

You are asked to answer a number of questions using REDIS Bitmaps. A Bitmap is the data structure that immediately pops in your head when the need is to map Boolean information for a huge domain into a compact representation. REDIS, being an in-memory data structure server, provides support for bit manipulation operations. However, there isn‚Äôt a special data structure for Bitmaps in REDIS. Rather, bit level operations are supported on the basic REDIS structure: Strings. Now, the maximum length for REDIS strings is 512 MB. Thus, the largest domain that REDIS can map as a Bitmap is 2^32 (512 MB = 2^29 bytes = 2^32 bits).

<pre>Bitmaps examples:
</pre>
Let‚Äôs take the following bitmap as an example. Each bit corresponds to a client. Our company has 8 clients in total. The value of 1 means that the client purchased something from our online store in August:

<pre>AugustSales:
</pre>
01101000 ‚Äì Clients at the 0,3,5,6,7 positions did not purchase anything.

</div>
</div>
<div class="layoutArea">
<div class="column">
Task 1.

</div>
</div>
</div>
<div class="page" title="Page 3">
<div class="layoutArea">
<div class="column">
‚Äì Clients at the 1,2,4 positions did at least one transaction in August. Let‚Äôs add another bitmap to the example. It contains the September sales of

the same company for the exact same clients: SeptemberSales:

11001100

<ul>
<li>‚Äì &nbsp;Clients at the 2,3,6,7 positions did not purchase anything.</li>
<li>‚Äì &nbsp;Clients at the 0,1,4,5 positions did at least one transaction in
September.

In order to create a Bitmap in REDIS you may use the SETBIT command. The

syntax of SETBIT is: &gt;&gt; SETBIT key offset value

In order to create the SeptemberSales Bitmap we should enter the following
</li>
</ul>
</div>
</div>
<div class="layoutArea">
<div class="column">
commands:

&gt;&gt; SETBIT &gt;&gt; SETBIT &gt;&gt; SETBIT &gt;&gt; SETBIT

</div>
<div class="column">
<pre>SeptemberSales 0 1
SeptemberSales 1 1
SeptemberSales 4 1
SeptemberSales 5 1
</pre>
</div>
</div>
<div class="layoutArea">
<div class="column">
Having these Bitmaps at hand, makes it very easy for us to calculate things like:

‚Äì Which clients ordered at least once for two months in a row?

‚Äì Which clients have not placed any orders within these two months?

This can be achieved with the use of bit-wise logical operations.

For example, in order to find out the clients that ordered at least once every month, we could perform an ‚ÄúAND‚Äù bitwise operation:

</div>
</div>
<div class="layoutArea">
<div class="column">
AugustSales SeptemberSales

AugustSales AND SeptemberSales

</div>
<div class="column">
01101000 11001100 01001000

</div>
</div>
<div class="layoutArea">
<div class="column">
In REDIS the following bitwise operations are supported:

</div>
</div>
<table>
<tbody>
<tr>
<td>
<div class="layoutArea">
<div class="column">
AND

</div>
</div>
</td>
<td>
<div class="layoutArea">
<div class="column">
A bitwise AND performs the logical AND operation on each pair of the corresponding bits. If both bits are 1, the bit in the resulting binary representation is 1 (1 &amp; 1 = 1); otherwise, the result is 0 (1 &amp; 0 = 0 and 0 &amp; 0 = 0).

For example: 0101 AND 0011 = 0001

</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="page" title="Page 4">
<table>
<tbody>
<tr>
<td>
<div class="layoutArea">
<div class="column">
OR

</div>
</div>
</td>
<td>
<div class="layoutArea">
<div class="column">
A bitwise OR performs the logical inclusive OR operation on each pair of corresponding bits. The result is 0 if both bits are 0; otherwise the result is 1.

For example: 0101 OR 0011 = 0111

</div>
</div>
</td>
</tr>
<tr>
<td>
<div class="layoutArea">
<div class="column">
XOR

</div>
</div>
</td>
<td>
<div class="layoutArea">
<div class="column">
A bitwise XOR performs the logical exclusive OR operation on each pair of corresponding bits. The result is 1 if only the first bit is 1 or only the second bit is 1, but will be 0 if both are 0 or both are 1.

For example: 0101 XOR 0011 = 0110

</div>
</div>
</td>
</tr>
<tr>
<td>
<div class="layoutArea">
<div class="column">
NOT

</div>
</div>
</td>
<td>
<div class="layoutArea">
<div class="column">
The bitwise NOT, performs logical negation on each bit. Bits that are 0 become 1, and those that are 1 become 0.

For example: NOT 0111 =&gt; 1000

</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="layoutArea">
<div class="column">
These operations are performed with the BITOP command. The results of each command are written in a new key.

</div>
</div>
<div class="layoutArea">
<div class="column">
The syntax is as follows:

Syntax

AND BITOP AND destkey srckey1 srckey2 OR BITOP OR destkey srckey1 srckey2 XOR BITOP XOR destkey srckey1 srckey2 NOT BITOP NOT destkey srckey

</div>
<div class="column">
Example

BITOP AND results AugustSales SeptemberSales BITOP OR results AugustSales SeptemberSales BITOP XOR results AugustSales SeptemberSales BITOP NOT results AugustSales

</div>
</div>
<div class="layoutArea">
<div class="column">
In all these examples, the results will be written in the key ‚Äúresults‚Äù.

In order to count the number of ‚Äú1‚Äùs in a key, we may use the BITCOUNT command. So, in order to count the number of clients that ordered in August, we would do: &gt;&gt; BITCOUNT AugustSales

Now that you are familiar with all the theory and tools that you need to work with Bitmaps in REDIS, let‚Äôs proceed with your assignment.

General Note: Some users may have received more than one e-mail in the same month. If a client opened at least one of the e-mails that she/he received in the same month then we will classify this client as having opened this month‚Äôs newsletter.

Provide answers for the following questions:

<ol>
<li>1.1 &nbsp;How many users modified their listing on January?
Tip: Create a BITMAP called ‚ÄúModificationsJanuary‚Äù and use ‚ÄúSETBIT -&gt; 1‚Äù for each user that modified their listing. Use BITCOUNT to calculate the answer.
</li>
<li>1.2 &nbsp;How many users did NOT modify their listing on January?
Tip: Use ‚ÄúBITOP NOT‚Äù to perform inversion on the ‚ÄúModificationsJanuary‚Äù BITMAP and use BITCOUNT to calculate the answer. Combine the results with the answer of 1.1. Do these numbers match the total of your users? Even if they don‚Äôt, an explanation of why this happens will give you the full grade. Keep in mind that all BITOP operations happen at byte-level increments.
</li>
</ol>
</div>
</div>
</div>
<div class="page" title="Page 5">
<div class="layoutArea">
<div class="column">
1.3 How many users received at least one e-mail per month (at least one e- mail in January and at least one e-mail in February and at least one e- mail in March)?

Tip: Create three BITMAPS ‚ÄúEmailsJanuary‚Äù, ‚ÄúEmailsFebruary‚Äù and ‚ÄúEmailsMarch‚Äù. Fill these with ‚ÄúSETBIT‚Äù and use ‚ÄúBITOP AND‚Äù followed by ‚ÄúBITCOUNT‚Äù in order to calculate the answer.

<ol start="4">
<li>1.4 &nbsp;How many users received an e-mail on January and March but NOT on February?
Tip: Perform ‚ÄúBITOP AND‚Äù on ‚ÄúEmailsJanuary‚Äù and ‚ÄúEmailsMarch‚Äù. Perform an

inversion of ‚ÄúEmailsFebruary‚Äù and use ‚ÄúBITOP AND‚Äù as well.
</li>
<li>1.5 &nbsp;How many users received an e-mail on January that they did not open but they updated their listing anyway?

Tip: Create a new BITMAP ‚ÄúEmailsOpenedJanuary‚Äù.</li>
<li>1.6 &nbsp;How many users received an e-mail on January that they did not open but they updated their listing anyway on January OR they received an e-mail on February that they did not open but they updated their listing anyway on February OR they received an e-mail on March that they did not open but they updated their listing anyway on March?</li>
</ol>
Tip: Create two new BITMAPs ‚ÄúEmailsOpenedFebruary‚Äù and ‚ÄúEmailsOpenedMarch‚Äù. Do the same thing you did on 1.5 and calculate the answer using ‚ÄúBITOP OR‚Äù.

<ol start="7">
<li>1.7 &nbsp;Does it make any sense to keep sending e-mails with recommendations to sellers? Does this strategy really work? How would you describe this in terms a business person would understand?

Tip: You may use the findings of the previous questions or calculate anything else you want in order to justify your answer.</li>
<li>1.8 &nbsp;(Optional Task) Do the previous subtasks again by using any type of relational or non-relational database. Compare the complexity of the solutions. Then benchmark the query execution time for the dataset that you have. At last, boost the number of entries to 1 billion rows (create your own dummy entries). Perform the benchmark again.</li>
</ol>
Task 2.

In this task you are going to use the ‚Äúbikes‚Äù dataset in order to generate

some analytics with MongoDB.

2.1 Add your data to MongoDB.

Tip 1: You are free to structure your data whatever way you see fit. Before deciding on that, read the other tasks below. These will help you in order to decide on the data cleaning actions that you need to perform. You are allowed to perform any data cleaning actions you like. Please document all the actions that you performed (briefly) along with the reasoning behind any of your actions. The dataset is not clean. You might need to remove entries (or edit them) in order to maintain a clean database.

Tip 2: You will need to read all the files from R, do some cleaning and then add the data to MongoDB. When dealing with files split in that many folders, there are two options on how you read these files. The first (simpler) option is to write some code that will recursively read each folder, discover the files and bring them to memory. If you choose this route, every time you execute your code, the files have to be re- discovered. This takes time. Another option is to generate a list with all the paths of the files and use this file as an index whenever you need to do some kind of manipulation (read/write) to these files. This

</div>
</div>
</div>
<div class="page" title="Page 6">
<div class="layoutArea">
<div class="column">
approach will be much faster. In order to build that file, open the folder through a terminal and run the following command:

o Windows Powershell: dir -Recurse -Name -File &gt; files_list.txt o Unix Terminal: find * | grep json &gt; files_list.txt

o Windows CMD: dir /a-D /S /B &gt; files_list.txt

Now, the only thing you have to do through your code is read the ‚Äúfiles_list.txt‚Äù line by line and load the file that is in the path contained in each row. No time will be spent in order to discover the files in case you want to re-run your code. In this assignment, you have a total of ~30K files. In a real-life scenario this number could have been several millions. In this case, the second option would most probably be your only option.

Tip 3: You will need to work on your data prior to writing to the database. Code samples of working with MongoDB through R are available on the ‚Äúmongo.r‚Äù file. Use this as a reference along with the documentation of the package used.

<ol start="2">
<li>2.2 &nbsp;How many bikes are there for sale?</li>
<li>2.3 &nbsp;What is the average price of a motorcycle (give a number)? What is the
number of listings that were used in order to calculate this average (give a number as well)? Is the number of listings used the same as the answer in 2.2? Why?
</li>
<li>2.4 &nbsp;What is the maximum and minimum price of a motorcycle currently available in the market?
Tip: The numbers should make sense.
</li>
<li>2.5 &nbsp;How many listings have a price that is identified as negotiable?
Tip: Search for the word ‚ÄúNegotiable‚Äù in the ad.
</li>
<li>2.6 &nbsp;(Optional) For each Brand, what percentage of its listings is listed as negotiable?</li>
<li>2.7 &nbsp;(Optional) What is the motorcycle brand with the highest average price?</li>
<li>2.8 &nbsp;(Optional) What are the TOP 10 models with the highest average age?
(Round age by one decimal number)

Tip: Calculate age based on registration date. You don‚Äôt need to take into account the months (only years). Group by model, calculate AVG Age and then Sort. Keep the TOP 10. In case of draws, treat it the same way you would in a real life scenario.
</li>
<li>2.9 &nbsp;(Optional) How many bikes have ‚ÄúABS‚Äù as an extra?</li>
<li>2.10 &nbsp;(Optional) What is the average Mileage of bikes that have ‚ÄúABS‚Äù AND
‚ÄúLed lights‚Äù as an extra?
</li>
<li>2.11 &nbsp;(Optional) What are the TOP 3 colors per bike category?</li>
<li>2.12 &nbsp;(Optional) Identify a set of ads that you consider ‚ÄúBest Deals‚Äù.
Tip: Describe ‚Äúwhy‚Äù in a manner that a business person would understand. Justify your decision with actual data. Even though it‚Äôs not really needed, you are free to use external data sources.
</li>
</ol>
</div>
</div>
</div>
